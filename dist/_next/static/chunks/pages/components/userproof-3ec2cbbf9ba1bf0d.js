(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[712],{8373:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/userproof",function(){return c(886)}])},886:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return D}});var d=c(7568),e=c(1438),f=c(8029),g=c(258),h=c(4051),i=c.n(h),j=c(5893),k=c(7294),l=c(214),m=c.n(l),n=c(6731),o=c(3461),p=c(7200),q=c(8764).Buffer,r=c(2325).tt;function s(a,b){return t.apply(this,arguments)}function t(){return(t=(0,d.Z)(i().mark(function a(b,c){var d;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!c){a.next=5;break}return a.next=3,c.viewArray(b);case 3:return d=a.sent,a.abrupt("return",d);case 5:case"end":return a.stop()}},a)}))).apply(this,arguments)}function u(a){for(var b=["0x"],c=0,d=a.length;c<d;c++){var e=Number(a.charCodeAt(c)).toString(16);b.push(e)}return b.join("")}function v(a,b){return w.apply(this,arguments)}function w(){return(w=(0,d.Z)(i().mark(function a(b,c){var d,e;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.ethereum){a.next=6;break}return d="0x".concat(q.from(c,"utf-8").toString("hex")),a.next=4,window.ethereum.request({method:"eth_decrypt",params:[d,b]});case 4:return e=a.sent,a.abrupt("return",e);case 6:case"end":return a.stop()}},a)}))).apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){return(y=(0,d.Z)(i().mark(function a(b){var c,d,e;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b){a.next=7;break}return a.next=3,b.credentialsSchema();case 3:return e=(d=JSON.parse(c=a.sent)).schema_json.claims,a.abrupt("return",e);case 7:case"end":return a.stop()}},a)}))).apply(this,arguments)}function z(a,b){return A.apply(this,arguments)}function A(){return(A=(0,d.Z)(i().mark(function a(b,c){var d,e,f,g;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b){a.next=11;break}return a.next=3,b.TREE_DEPTH();case 3:return d=a.sent,a.next=6,b.getLeavesArray();case 6:return e=a.sent,f=new p.a(o.poseidon,d,BigInt(0),2),e.forEach(function(a){f.insert(a.toBigInt())}),g=f.createProof(c-1),a.abrupt("return",g);case 11:case"end":return a.stop()}},a)}))).apply(this,arguments)}function B(a,b,c,d){return C.apply(this,arguments)}function C(){return(C=(0,d.Z)(i().mark(function a(b,c,d,e){var f,g,h,j,k,l,m,o,p;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(f=b.claims.ethAddress,g=[],c)for(h in c)"ethAddress"!==c[h]?g.push(u(b.claims[c[h]])):g.push(b.claims[c[h]]);return j=d.siblings.map(function(a){return n.O$.from(a[0]).toHexString()}),k=(k=n.O$.from(d.root)).toHexString(),l={ClaimsVals:g,MerkleProofSiblings:j,MerkleProofPathIndices:d.pathIndices,MerkleProofRoot:k,EthAddress:f,DisclosureVector:e},a.next=9,r.fullProve(l,"zkVerifiableCredentialsDBCore.wasm","circuit_final.zkey");case 9:return o=(m=a.sent).proof,p=m.publicSignals,a.abrupt("return",{proof:o,publicSignals:p});case 13:case"end":return a.stop()}},a)}))).apply(this,arguments)}var D=function(a){(0,f.Z)(c,a);var b=(0,g.Z)(c);function c(){return(0,e.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){var a=this,b=this,c=this;return(0,j.jsxs)("div",{className:m().issuerContainer,children:[(0,j.jsx)("h1",{children:"Proover portal"}),(0,j.jsx)("h2",{children:"Recover your credential"}),(0,j.jsxs)("div",{className:m().credNumberIn,children:[" ",(0,j.jsx)("p",{children:"Input your credential # "})," ",(0,j.jsx)("input",{onChange:function(b){var c=Number.parseInt(b.target.value);a.setState(function(a){return{credentialNumber:c}})}})]}),(0,j.jsx)("button",{onClick:(0,d.Z)(i().mark(function a(){var c,d,e,f,g;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,x(b.props.credentialsDB);case 2:return c=a.sent,a.next=5,s(b.state.credentialNumber-1,b.props.credentialsDB);case 5:return d=a.sent,a.next=8,v(b.props.walletAddress,d);case 8:f=JSON.parse(e=a.sent),g=c.map(function(a){return 0}),b.setState(function(a){return{claimsArray:c,credentialJSON:f,disclosureVector:g}});case 12:case"end":return a.stop()}},a)})),children:"Recover"}),this.state&&this.state.credentialJSON&&this.state.claimsArray?(0,j.jsxs)("div",{className:m().issuerContainer,children:[(0,j.jsx)("h3",{children:"Recovered credential"}),(0,j.jsx)("ul",{children:this.state.claimsArray.map(function(b){return(0,j.jsxs)("li",{children:[b," = ",a.state.credentialJSON.claims[b]]},b)})}),(0,j.jsx)("h3",{children:"Selective disclosure selection"}),this.state.claimsArray.map(function(b,c){return(0,j.jsxs)("div",{className:m().credNumberIn,children:[(0,j.jsx)("p",{children:b})," ",(0,j.jsx)("input",{type:"checkbox",onChange:function(b){var d=a.state.disclosureVector;d[c]=b.target.checked?1:0,a.setState(function(a){return{disclosureVector:d}})}})]},b)}),(0,j.jsx)("button",{onClick:(0,d.Z)(i().mark(function a(){var b,d,e,f,g;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,z(c.props.credentialsDB,c.state.credentialNumber);case 2:return b=a.sent,a.next=5,B(c.state.credentialJSON,c.state.claimsArray,b,c.state.disclosureVector);case 5:e=(d=a.sent).proof,f=d.publicSignals,g={proof:e,publicSignals:f},c.setState(function(a){return{proof:JSON.stringify(g)}});case 10:case"end":return a.stop()}},a)})),children:"Generate proof"})]}):(0,j.jsx)("div",{}),(0,j.jsx)("div",{children:this.state&&this.state.proof?(0,j.jsxs)("div",{children:[(0,j.jsx)("textarea",{rows:15,cols:100,children:this.state.proof})," "]}):(0,j.jsx)("div",{})})]})},c}(k.Component)},214:function(a){a.exports={container:"Home_container__bCOhY",main:"Home_main__nLjiQ",footer:"Home_footer____T7K",header:"Home_header__GCVRv",title:"Home_title__T09hD",conButton:"Home_conButton__cn8D3",conButtonAddress:"Home_conButtonAddress__gF3ft",issuerContainer:"Home_issuerContainer__eMDro",issuerForm:"Home_issuerForm__kJ0v2",formLabel:"Home_formLabel__U6w15",issuerFormContainer:"Home_issuerFormContainer__5rpbZ",modalBackground:"Home_modalBackground__Rn404",modalContainer:"Home_modalContainer__RUPnO",issueStep:"Home_issueStep__FMisM",loadingSpinner:"Home_loadingSpinner__G8du1",spinner:"Home_spinner__DDWoZ",check:"Home_check__G1jDm",userSelection:"Home_userSelection__YDsZD",credNumberIn:"Home_credNumberIn__hvoCh",verifyButton:"Home_verifyButton__G3Lww"}},8677:function(){},6601:function(){},9214:function(){},299:function(){},7790:function(){},5979:function(){},2361:function(){},4616:function(){},6567:function(){},7503:function(){},7500:function(){},7200:function(a,b,c){"use strict";/**
 * @module @zk-kit/incremental-merkle-tree
 * @version 0.4.3
 * @file Incremental Merkle tree implementation in TypeScript.
 * @copyright Omar Desogus 2022
 * @license MIT
 * @see [Github]{@link https://github.com/appliedzkp/zk-kit/tree/main/packages/incremental-merkle-tree}
*/ function d(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];if(void 0===a)throw TypeError("Parameter '".concat(b,"' is not defined"));if(!c.includes(typeof a))throw TypeError("Parameter '".concat(b,"' is none of these types: ").concat(c.join(", ")))}function e(a,b,c,e,f,g,h){if(d(a,"index","number"),a<0||a>=f[0].length)throw Error("The leaf does not exist in this tree");for(var i=b,j=0;j<c;j+=1){var k=a%e,l=a-k,m=l+e,n=[];f[j][a]=i;for(var o=l;o<m;o+=1)o<f[j].length?n.push(f[j][o]):n.push(g[j]);i=h(n),a=Math.floor(a/e)}return i}c.d(b,{a:function(){return f}});var f=function(){function a(b,c,e,f){if(void 0===f&&(f=2),d(b,"hash","function"),d(c,"depth","number"),d(e,"zeroValue","number","string","bigint"),d(f,"arity","number"),c<1||c>a.maxDepth)throw Error("The tree depth must be between 1 and 32");this._hash=b,this._depth=c,this._zeroes=[],this._nodes=[],this._arity=f;for(var g=0;g<c;g+=1)this._zeroes.push(e),this._nodes[g]=[],e=b(Array(this._arity).fill(e));this._root=e,Object.freeze(this._zeroes),Object.freeze(this._nodes)}return Object.defineProperty(a.prototype,"root",{get:function(){return this._root},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"depth",{get:function(){return this._depth},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"leaves",{get:function(){return this._nodes[0].slice()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"zeroes",{get:function(){return this._zeroes},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"arity",{get:function(){return this._arity},enumerable:!1,configurable:!0}),a.prototype.indexOf=function(a){var b,c;return b=a,c=this._nodes,d(b,"leaf","number","string","bigint"),c[0].indexOf(b)},a.prototype.insert=function(a){this._root=function(a,b,c,e,f,g){if(d(a,"leaf","number","string","bigint"),e[0].length>=Math.pow(c,b))throw Error("The tree is full");for(var h=a,i=e[0].length,j=0;j<b;j+=1){var k=i%c,l=i-k,m=l+c,n=[];e[j][i]=h;for(var o=l;o<m;o+=1)o<e[j].length?n.push(e[j][o]):n.push(f[j]);h=g(n),i=Math.floor(i/c)}return h}(a,this.depth,this.arity,this._nodes,this.zeroes,this._hash)},a.prototype.delete=function(a){this._root=e(a,this.zeroes[0],this.depth,this.arity,this._nodes,this.zeroes,this._hash)},a.prototype.update=function(a,b){this._root=e(a,b,this.depth,this.arity,this._nodes,this.zeroes,this._hash)},a.prototype.createProof=function(a){return function(a,b,c,e,f,g){if(d(a,"index","number"),a<0||a>=e[0].length)throw Error("The leaf does not exist in this tree");for(var h=[],i=[],j=a,k=0;k<b;k+=1){var l=a%c,m=a-l,n=m+c;i[k]=l,h[k]=[];for(var o=m;o<n;o+=1)o!==a&&(o<e[k].length?h[k].push(e[k][o]):h[k].push(f[k]));a=Math.floor(a/c)}return{root:g,leaf:e[0][j],pathIndices:i,siblings:h}}(a,this.depth,this.arity,this._nodes,this.zeroes,this.root)},a.prototype.verifyProof=function(a){return function(a,b){d(a,"proof","object"),d(a.root,"proof.root","number","string","bigint"),d(a.leaf,"proof.leaf","number","string","bigint"),d(a.siblings,"proof.siblings","object"),d(a.pathIndices,"proof.pathElements","object");for(var c=a.leaf,e=0;e<a.siblings.length;e+=1){var f=a.siblings[e].slice();f.splice(a.pathIndices[e],0,c),c=b(f)}return a.root===c}(a,this._hash)},a.maxDepth=32,a}()}},function(a){a.O(0,[714,808,322,639,792,709,461,838,774,888,179],function(){var b;return a(a.s=8373)}),_N_E=a.O()}])