(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(1442)}])},886:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return D}});var d=c(7568),e=c(1438),f=c(8029),g=c(258),h=c(4051),i=c.n(h),j=c(5893),k=c(7294),l=c(214),m=c.n(l),n=c(6731),o=c(3461),p=c(7200),q=c(8764).Buffer,r=c(2325).tt;function s(a,b){return t.apply(this,arguments)}function t(){return(t=(0,d.Z)(i().mark(function a(b,c){var d;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!c){a.next=5;break}return a.next=3,c.viewArray(b);case 3:return d=a.sent,a.abrupt("return",d);case 5:case"end":return a.stop()}},a)}))).apply(this,arguments)}function u(a){for(var b=["0x"],c=0,d=a.length;c<d;c++){var e=Number(a.charCodeAt(c)).toString(16);b.push(e)}return b.join("")}function v(a,b){return w.apply(this,arguments)}function w(){return(w=(0,d.Z)(i().mark(function a(b,c){var d,e;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.ethereum){a.next=6;break}return d="0x".concat(q.from(c,"utf-8").toString("hex")),a.next=4,window.ethereum.request({method:"eth_decrypt",params:[d,b]});case 4:return e=a.sent,a.abrupt("return",e);case 6:case"end":return a.stop()}},a)}))).apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){return(y=(0,d.Z)(i().mark(function a(b){var c,d,e;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b){a.next=7;break}return a.next=3,b.credentialsSchema();case 3:return e=(d=JSON.parse(c=a.sent)).schema_json.claims,a.abrupt("return",e);case 7:case"end":return a.stop()}},a)}))).apply(this,arguments)}function z(a,b){return A.apply(this,arguments)}function A(){return(A=(0,d.Z)(i().mark(function a(b,c){var d,e,f,g;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b){a.next=11;break}return a.next=3,b.TREE_DEPTH();case 3:return d=a.sent,a.next=6,b.getLeavesArray();case 6:return e=a.sent,f=new p.a(o.poseidon,d,BigInt(0),2),e.forEach(function(a){f.insert(a.toBigInt())}),g=f.createProof(c-1),a.abrupt("return",g);case 11:case"end":return a.stop()}},a)}))).apply(this,arguments)}function B(a,b,c,d){return C.apply(this,arguments)}function C(){return(C=(0,d.Z)(i().mark(function a(b,c,d,e){var f,g,h,j,k,l,m,o,p;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(f=b.claims.ethAddress,g=[],c)for(h in c)"ethAddress"!==c[h]?g.push(u(b.claims[c[h]])):g.push(b.claims[c[h]]);return j=d.siblings.map(function(a){return n.O$.from(a[0]).toHexString()}),k=(k=n.O$.from(d.root)).toHexString(),l={ClaimsVals:g,MerkleProofSiblings:j,MerkleProofPathIndices:d.pathIndices,MerkleProofRoot:k,EthAddress:f,DisclosureVector:e},a.next=9,r.fullProve(l,"zkVerifiableCredentialsDBCore.wasm","circuit_final.zkey");case 9:return o=(m=a.sent).proof,p=m.publicSignals,a.abrupt("return",{proof:o,publicSignals:p});case 13:case"end":return a.stop()}},a)}))).apply(this,arguments)}var D=function(a){(0,f.Z)(c,a);var b=(0,g.Z)(c);function c(){return(0,e.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){var a=this,b=this,c=this;return(0,j.jsxs)("div",{className:m().issuerContainer,children:[(0,j.jsx)("h1",{children:"Proover portal"}),(0,j.jsx)("h2",{children:"Recover your credential"}),(0,j.jsxs)("div",{className:m().credNumberIn,children:[" ",(0,j.jsx)("p",{children:"Input your credential # "})," ",(0,j.jsx)("input",{onChange:function(b){var c=Number.parseInt(b.target.value);a.setState(function(a){return{credentialNumber:c}})}})]}),(0,j.jsx)("button",{onClick:(0,d.Z)(i().mark(function a(){var c,d,e,f,g;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,x(b.props.credentialsDB);case 2:return c=a.sent,a.next=5,s(b.state.credentialNumber-1,b.props.credentialsDB);case 5:return d=a.sent,a.next=8,v(b.props.walletAddress,d);case 8:f=JSON.parse(e=a.sent),g=c.map(function(a){return 0}),b.setState(function(a){return{claimsArray:c,credentialJSON:f,disclosureVector:g}});case 12:case"end":return a.stop()}},a)})),children:"Recover"}),this.state&&this.state.credentialJSON&&this.state.claimsArray?(0,j.jsxs)("div",{className:m().issuerContainer,children:[(0,j.jsx)("h3",{children:"Recovered credential"}),(0,j.jsx)("ul",{children:this.state.claimsArray.map(function(b){return(0,j.jsxs)("li",{children:[b," = ",a.state.credentialJSON.claims[b]]},b)})}),(0,j.jsx)("h3",{children:"Selective disclosure selection"}),this.state.claimsArray.map(function(b,c){return(0,j.jsxs)("div",{className:m().credNumberIn,children:[(0,j.jsx)("p",{children:b})," ",(0,j.jsx)("input",{type:"checkbox",onChange:function(b){var d=a.state.disclosureVector;d[c]=b.target.checked?1:0,a.setState(function(a){return{disclosureVector:d}})}})]},b)}),(0,j.jsx)("button",{onClick:(0,d.Z)(i().mark(function a(){var b,d,e,f,g;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,z(c.props.credentialsDB,c.state.credentialNumber);case 2:return b=a.sent,a.next=5,B(c.state.credentialJSON,c.state.claimsArray,b,c.state.disclosureVector);case 5:e=(d=a.sent).proof,f=d.publicSignals,g={proof:e,publicSignals:f},c.setState(function(a){return{proof:JSON.stringify(g)}});case 10:case"end":return a.stop()}},a)})),children:"Generate proof"})]}):(0,j.jsx)("div",{}),(0,j.jsx)("div",{children:this.state&&this.state.proof?(0,j.jsxs)("div",{children:[(0,j.jsx)("textarea",{rows:15,cols:100,children:this.state.proof})," "]}):(0,j.jsx)("div",{})})]})},c}(k.Component)},1442:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return u}});var d=c(7568),e=c(4051),f=c.n(e),g=c(5893),h=c(7294),i=c(9008),j=c.n(i),k=c(715),l=c(3651),m=c(4146),n=c(214),o=c.n(n),p=JSON.parse('{"Mt":[{"inputs":[{"internalType":"address","name":"_verifier","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint32","name":"credentialNo","type":"uint32"}],"name":"CredentialSavedInRegister","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"leaf","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"root","type":"uint256"}],"name":"LeafInserted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[],"name":"TREE_DEPTH","outputs":[{"internalType":"uint32","name":"","type":"uint32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"credentialsCounter","outputs":[{"internalType":"uint32","name":"","type":"uint32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"credentialsRegister","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"credentialsSchema","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"credentialsSchemaSet","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLeavesArray","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMerkleRoot","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"leavesArray","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"data","type":"string"},{"internalType":"uint256","name":"leaf","type":"uint256"}],"name":"saveCredential","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"schema","type":"string"}],"name":"setCredentialsSchema","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"tree","outputs":[{"internalType":"uint256","name":"depth","type":"uint256"},{"internalType":"uint256","name":"root","type":"uint256"},{"internalType":"uint256","name":"numberOfLeaves","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"verifier","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"i","type":"uint256"}],"name":"viewArray","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}]}'),q=c(9385),r=c(886),s=c(5334),t=function(){var a=(0,h.useState)(""),b=a[0],c=a[1],e=(0,h.useState)(""),i=e[0],n=e[1],t=(0,h.useState)(void 0),u=(t[0],t[1]),v=(0,h.useState)(void 0),w=v[0],x=v[1],y=(0,h.useState)(void 0),z=y[0],A=y[1],B=(0,h.useState)(!1),C=B[0],D=B[1],E=(0,h.useState)(!1),F=E[0],G=E[1],H=(0,h.useState)("default"),I=H[0],J=H[1];function K(){return L.apply(this,arguments)}function L(){return(L=(0,d.Z)(f().mark(function a(){var b;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.ethereum){a.next=13;break}return a.prev=1,a.next=4,window.ethereum.request({method:"eth_requestAccounts"});case 4:c((b=a.sent)[0]),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),console.log(a.t0);case 11:a.next=14;break;case 13:console.log("metamask not found");case 14:case"end":return a.stop()}},a,null,[[1,8]])}))).apply(this,arguments)}function M(){return(M=(0,d.Z)(f().mark(function a(){var b,c,d,e,g,h;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(void 0!==window.ethereum)){a.next=26;break}return a.next=3,K();case 3:return a.next=5,new k.Q(window.ethereum);case 5:return b=a.sent,a.next=8,u(b);case 8:return a.next=10,b.getSigner();case 10:return c=a.sent,a.next=13,x(c);case 13:if(!b){a.next=26;break}return d=new l.vU(p.Mt),e=new m.CH("0x1D5d8bF49494B9d4E83Ff4Bf7c25Cd3B8cA284b4",d,c),a.next=18,A(e);case 18:return a.next=20,e.owner();case 20:return g=a.sent,a.next=23,c.getAddress();case 23:g==(h=a.sent)&&D(!0),G(!0);case 26:case"end":return a.stop()}},a)}))).apply(this,arguments)}function N(a){return O.apply(this,arguments)}function O(){return(O=(0,d.Z)(f().mark(function a(b){var c;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.ethereum){a.next=5;break}return a.next=3,window.ethereum.request({method:"eth_getEncryptionPublicKey",params:[b]});case 3:return c=a.sent,a.abrupt("return",c);case 5:case"end":return a.stop()}},a)}))).apply(this,arguments)}return(0,g.jsxs)("div",{className:o().container,children:[(0,g.jsxs)(j(),{children:[(0,g.jsx)("title",{children:"ZK Verifiable credentials App"}),(0,g.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,g.jsxs)("header",{className:o().header,children:[(0,g.jsx)("h3",{children:"ZK Verifiable credentials App"}),(0,g.jsx)("div",{children:""==b?(0,g.jsxs)("button",{className:o().conButton,onClick:function(){return function(){return M.apply(this,arguments)}()},children:[" ",(0,g.jsx)("div",{children:"Connect Wallet"})]}):(0,g.jsx)("div",{className:o().conButtonAddress,children:b.slice(0,7)+"..."+b.slice(-4)})})]}),F?(0,g.jsx)("main",{className:o().main,children:C?(0,g.jsx)(q.default,{walletAddress:b,credentialsDB:z}):(0,g.jsx)("div",{children:{proove:(0,g.jsx)(r.default,{walletAddress:b,credentialsDB:z}),verify:(0,g.jsx)(s.default,{walletAddress:b,credentialsDB:z,signer:w}),getPubAdd:(0,g.jsx)("div",{children:(0,g.jsxs)("h4",{children:["Your public key: ",i]})}),default:(0,g.jsxs)("div",{className:o().main,children:[(0,g.jsx)("h1",{children:"What you want to do?"}),(0,g.jsxs)("div",{className:o().userSelection,children:[(0,g.jsx)("button",{onClick:function(){J("proove")},children:"Prove your credential"}),(0,g.jsx)("button",{onClick:function(){J("verify")},children:"Verify a proof"}),(0,g.jsx)("button",{onClick:(0,d.Z)(f().mark(function a(){var c;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return J("getPubAdd"),a.next=3,N(b);case 3:(c=a.sent)&&n(c);case 5:case"end":return a.stop()}},a)})),children:"Get your public key"})]})]})}[I]})}):(0,g.jsxs)("main",{className:o().main,children:[(0,g.jsx)("h1",{children:"Connect your wallet first"}),(0,g.jsx)("p",{children:"Your type of account will be automatically detected"})]})]})},u=t}},function(a){a.O(0,[714,808,322,639,792,709,461,838,146,91,479,769,664,774,888,179],function(){var b;return a(a.s=8312)}),_N_E=a.O()}])